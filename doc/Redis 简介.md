**Redis（Remote Dictionary Server）** 是一个开源的、基于内存的 **高性能键值（Key-Value）数据库**，由 Salvatore Sanfilippo（antirez）于 2009 年创建。它不仅支持简单的字符串存储，还提供了丰富的**数据结构**（如列表、集合、哈希、有序集合等），并具备**持久化、高可用、分布式、事务、发布订阅**等企业级能力，广泛应用于缓存、会话存储、消息队列、实时排行榜、限流等场景。

📚 官网：https://redis.io
📘 中文文档：https://redis.cn
📘 GitHub：https://github.com/redis/redis

------

## 🌟 核心特性

| 特性             | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **内存存储**     | 数据常驻内存，读写速度极快（10万+ QPS）                      |
| **丰富数据结构** | String、Hash、List、Set、ZSet、Bitmap、HyperLogLog、Stream 等 |
| **持久化支持**   | RDB（快照） + AOF（日志）双机制，保障数据不丢失              |
| **高可用架构**   | 主从复制（Replication）、哨兵（Sentinel）、集群（Cluster）   |
| **原子操作**     | 所有命令单线程执行，天然线程安全                             |
| **发布/订阅**    | 支持 Pub/Sub 消息模式                                        |
| **Lua 脚本**     | 支持在服务端执行原子性 Lua 脚本                              |
| **过期策略**     | 支持为 key 设置 TTL（Time To Live）                          |
| **多语言客户端** | 官方/社区提供 Java、Python、Go、Node.js 等 SDK               |

> ✅ **性能表现**：
>
> - 读：约 **110,000 次/秒**
> - 写：约 **80,000 次/秒**
> - 延迟：通常 **亚毫秒级**

------

## 📦 核心数据结构及典型应用场景

| 数据类型              | 结构特点                             | 典型应用场景                                                 |
| --------------------- | ------------------------------------ | ------------------------------------------------------------ |
| **String**            | 最基础类型，可存字符串、整数、浮点数 | 缓存、计数器（INCR）、分布式锁（SETNX）                      |
| **Hash**              | 字段-值映射（类似 Map）              | 存储对象（如用户信息：`user:1001 -> {name: "Alice", age: 30}`） |
| **List**              | 双向链表                             | 消息队列（LPUSH/RPOP）、最新 N 条消息（如朋友圈动态）        |
| **Set**               | 无序、唯一元素集合                   | 标签系统、共同好友、去重                                     |
| **Sorted Set (ZSet)** | 有序集合，按 score 排序              | 排行榜（如游戏积分榜）、延迟任务队列                         |
| **Bitmap**            | 位图（底层是 String）                | 用户签到、活跃统计（节省空间）                               |
| **HyperLogLog**       | 概率统计算法                         | UV 统计（亿级用户去重，误差 <1%）                            |
| **Stream**            | 类 Kafka 的日志结构（5.0+）          | 消息队列、事件溯源、日志收集                                 |

------

## ⏱️ 持久化机制

Redis 提供两种持久化方式，可单独或组合使用：

### 1. **RDB（Redis Database）**

- **原理**：定时生成内存快照（二进制文件 `dump.rdb`）

- **优点**：文件紧凑、恢复快、适合备份

- **缺点**：可能丢失最后一次快照后的数据

- **触发方式**：

  ```txt
  save 900 1     # 900秒内至少1次修改
  save 300 10    # 300秒内至少10次修改
  ```

### 2. **AOF（Append Only File）**

- **原理**：记录所有写操作命令，重启时重放
- **优点**：数据更安全（可配置 fsync 策略）
- **缺点**：文件大、恢复慢
- **同步策略**：
  - `appendfsync always`：每次写都刷盘（最安全，性能差）
  - `appendfsync everysec`：每秒刷盘（推荐，平衡安全与性能）
  - `appendfsync no`：由 OS 决定（最快，可能丢数据）

> ✅ **混合持久化（4.0+）**：
>  RDB + AOF 结合，重写 AOF 时使用 RDB 格式前缀，兼顾恢复速度与数据安全。

------

## 🔄 高可用与扩展

### 1. **主从复制（Replication）**

- 一主多从，异步复制
- 从节点可处理读请求，分担主节点压力
- 支持 **无盘复制**（直接 socket 传输 RDB）

### 2. **哨兵模式（Sentinel）**

- 监控主从状态
- 自动故障转移（Failover）
- 服务发现（客户端通过 Sentinel 获取主节点地址）

```mer
graph LR
    Client --> Sentinel
    Sentinel -->|监控| Master
    Sentinel -->|监控| Slave1
    Sentinel -->|监控| Slave2
    Master -->|异步复制| Slave1
    Master -->|异步复制| Slave2
```



### 3. **Redis Cluster（集群）**

- **去中心化**：无单点瓶颈
- **数据分片**：16384 个 slot，自动分配到多个节点
- **高可用**：每个主节点可配从节点，主挂后自动切换
- **客户端直连**：无需代理，智能路由

> ✅ **Cluster 优势**：
>
> - 水平扩展（最多 1000 节点）
> - 自动故障转移
> - 支持在线扩缩容

------

## 🔐 安全与管理

| 功能             | 说明                                |
| ---------------- | ----------------------------------- |
| **认证**         | `requirepass your_password`         |
| **ACL（6.0+）**  | 细粒度权限控制（用户/命令/键权限）  |
| **SSL/TLS**      | 加密客户端连接（7.0+ 原生支持）     |
| **慢查询日志**   | `slowlog` 分析耗时命令              |
| **内存淘汰策略** | 当内存不足时自动清理（如 LRU、LFU） |

------

## 🛠️ 典型应用场景

| 场景          | Redis 方案                                  |
| ------------- | ------------------------------------------- |
| **缓存**      | String 缓存热点数据，设置 TTL               |
| **分布式锁**  | `SET key value NX PX 30000`（Redlock 算法） |
| **秒杀/限流** | Lua 脚本 + INCR + EXPIRE 原子操作           |
| **排行榜**    | ZSet（score=分数，member=用户ID）           |
| **消息队列**  | List（简单队列） 或 Stream（可靠队列）      |
| **用户签到**  | Bitmap（每天一个 bit，365 天仅需 46 字节）  |
| **UV 统计**   | HyperLogLog（1.5KB 内存统计亿级 UV）        |
| **会话存储**  | Hash 存储用户 session                       |

------

## 📊 Redis vs 其他数据库

| 对比项       | Redis                   | Memcached | MySQL           |
| ------------ | ----------------------- | --------- | --------------- |
| **数据结构** | 丰富（8+ 种）           | 仅 String | 表结构          |
| **持久化**   | ✅ RDB/AOF               | ❌ 纯内存  | ✅ Binlog/InnoDB |
| **高可用**   | ✅ Sentinel/Cluster      | ❌ 无      | ✅ 主从/MGR      |
| **事务**     | ✅ MULTI/EXEC（非 ACID） | ❌         | ✅ ACID          |
| **适用场景** | 缓存、实时数据          | 简单缓存  | 持久化业务数据  |

------

## 🚀 快速体验（Docker）

```bash
# 启动 Redis
docker run -d \
  --name redis \
  -p 6379:6379 \
  redis:7.2-alpine \
  redis-server --appendonly yes

# 连接测试
docker exec -it redis redis-cli
127.0.0.1:6379> SET hello "world"
OK
127.0.0.1:6379> GET hello
"world"
```

------

## ✅ 总结

> **Redis 是现代应用架构中不可或缺的“瑞士军刀”——它不仅是缓存，更是高性能数据处理引擎。**

凭借其**极致性能、丰富数据结构、灵活部署模式**，Redis 已成为：

- 缓存层的**事实标准**
- 实时系统的**核心组件**
- 微服务架构的**关键基础设施**

无论是小型项目还是超大规模互联网系统（如 Twitter、GitHub、阿里、腾讯），Redis 都扮演着至关重要的角色。

------

